# AutoSpecAnalyzer
大模型OCR+爬取+数据表查找
# 使用说明

## 功能介绍

`main.py` 脚本能够从 `specs.txt` 文件中提取不锈钢订单信息（公司、规格、厚度、长宽），然后在 `compare_data.xlsx` 数据表中进行筛选，只要满足任一条件即可。

## 文件说明

- **输入文件1**: `specs.txt` - 包含订单详细信息的文本文件
- **输入文件2**: `compare_data.xlsx` - 需要筛选的数据表（71,060行数据）
- **输出文件**: `main.xlsx` - 筛选后的结果数据表

## 提取的信息

脚本从 `specs.txt` 中提取以下信息：

1. **公司名称**: 供应商名称
2. **材质**: 如 304 不锈钢等材料代号
3. **厚度**: 订单中的厚度值（mm），包括：
   - 0.94, 1.0, 1.15, 1.2, 1.45, 1.5, 1.95, 2.0, 2.95, 3.0 mm
4. **规格（长宽）**: 如 1*2, 2.4*1.2, 2440*1220 等

## 筛选逻辑

脚本采用**"或"逻辑**，即只要满足以下任一条件，数据行就会被保留：

- 公司名称匹配
- 材质匹配（如304）
- 厚度匹配（±0.1mm 容差）
- 规格匹配（支持多种格式：1*2, 1.2*2.4, 1220*2440等）

## 筛选结果

- **原始数据**: 71,060 行
- **筛选后数据**: 48,866 行
- **主要匹配项**:
  - 材质304: 7,106 条
  - 规格1*2: 18,190 条
  - 各种厚度值: 多条匹配

## 使用方法

直接运行脚本即可：

```bash
python main.py
```

脚本会自动：
1. 读取并解析 `specs.txt`
2. 在 `compare_data.xlsx` 中筛选匹配数据
3. 将结果保存到 `filtered_specs_result.xlsx`
4. 显示详细的处理过程和统计信息

## 输出示例

筛选后的数据包含以下列：
- 材质
- materialId
- 规格
- 公司
- 厚度
- 产地
- 状态
- 价格
- 编号
- 时间

## 依赖库

需要安装Python库： pandas openpyxl requests watchdog
```bash
 pip install -r requirements.txt
```

## 注意事项

需要使用千问视觉的模型api
日期不变（测试时因为生成excel时间过长，可手动更改）
脚本使用UTF-8编码读取文件
厚度匹配时使用±0.1mm的容差范围
支持多种规格格式的匹配（米、毫米、整数、小数）
筛选采用"或"逻辑，满足任一条件即可

